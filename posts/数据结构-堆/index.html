<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="天前"><meta name="hour-prompt" content="小时前"><meta name="minute-prompt" content="分钟前"><meta name="justnow-prompt" content="刚刚"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="数据结构–堆" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="堆（Heap）是一棵完全二叉树，没有使用父指针和子指针，使用数组描述。" /><meta property="og:description" content="堆（Heap）是一棵完全二叉树，没有使用父指针和子指针，使用数组描述。" /><link rel="canonical" href="https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/" /><meta property="og:url" content="https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/" /><meta property="og:site_name" content="Cloud" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-10-01T00:20:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="数据结构–堆" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2019-10-22T23:20:46+08:00","datePublished":"2019-10-01T00:20:00+08:00","description":"堆（Heap）是一棵完全二叉树，没有使用父指针和子指针，使用数组描述。","headline":"数据结构–堆","mainEntityOfPage":{"@type":"WebPage","@id":"https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/"},"url":"https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/"}</script><title>数据结构--堆 | Cloud</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Cloud"><meta name="application-name" content="Cloud"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="zh-CN"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/22742796?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">Cloud</a></div><div class="site-subtitle font-italic">一条咸鱼</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/imcloudfloating" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['wfloatingcloud','outlook.com'].join('@')" aria-label="email" class="order-4" > <i class="fas fa-envelope"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/blog/"> 首页 </a> </span> <span>数据结构--堆</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>数据结构--堆</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Cloud Li </span> 发表于 <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="2019-10-01, 00:20 +0800" >2019-10-01<i class="unloaded">2019-10-01T00:20:00+08:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1755 字">9 分钟 阅读</span></div></div><div class="post-content"><p>堆（Heap）是一棵完全二叉树，没有使用父指针和子指针，使用数组描述。</p><blockquote><p>完全二叉树的特点：按照从上到下，从左向右的顺序填充，当前层没有填满时不允许填下一层。</p></blockquote><h2 id="堆的属性">堆的属性</h2><p>堆分为<strong>大根堆</strong>（最大堆）和<strong>小根堆</strong>（最小堆）。</p><ul><li>在大根堆中，父节点的值比每一个子节点的值都要大。<li>在小根堆中，父节点的值比每一个子节点都要小。</ul><p>大根堆的根节点永远是最大值，小根堆的根节点永远是最小值。</p><h2 id="堆的存储结构">堆的存储结构</h2><p>将以下数组存放在堆中</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[7, 6, 5, 2, 3]
</pre></table></code></div></div><p>节点在数组中的位置 i 与它的父子节点之间存在一个映射关系：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span text-data=" Plaintext "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>parent(i) = floor((i - 1) / 2)
left(i) = 2i + 1
right(i) = 2i + 2
</pre></table></code></div></div><p>一个节点的父节点等于它的索引减去 1 除 2 向下取整。左右节点的索引总是相邻。</p><div class="table-wrapper"><table><thead><tr><th>节点<th>索引<th>父节点索引<th>左子节点索引<th>右子节点索引<tbody><tr><td>7<td>0<td>-1<td>1<td>2<tr><td>7<td>1<td>0<td>3<td>4<tr><td>5<td>2<td>0<td>5<td>6<tr><td>2<td>3<td>1<td>7<td>8<tr><td>3<td>4<td>1<td>9<td>10</table></div><p>根节点 7 没有父节点，它的父节点索引是 -1，节点 5、2、3 没有子节点，它们的子节点索引超过了数组的最大索引。在使用时要判断索引是否是有效值。</p><h2 id="堆的操作">堆的操作</h2><p>两个原子操作保证在插入和删除节点维持堆的属性：</p><ul><li><code class="language-plaintext highlighter-rouge">shiftUp()</code> ： 如果一个节点比它的父节点大（大根堆）或小（小根堆），需要将这个节点与父节点交换位置。<li><code class="language-plaintext highlighter-rouge">shiftDown()</code> ：如果一个节点比它的子节点小（大根堆）或大（小根堆），需要将这个节点与（左或者右）子节点交换位置。</ul><p>以上两个操作是一个递归的过程，时间复杂度 O(log N) 。基于这两个原子操作还有一些其他的操作：</p><ul><li><code class="language-plaintext highlighter-rouge">insert(value)</code> ：在堆的尾部插入一个节点，然后使用 <code class="language-plaintext highlighter-rouge">shiftUp()</code> 来修复堆属性。<li><code class="language-plaintext highlighter-rouge">remove()</code> ：删除并返回堆顶节点。将最后一个节点放被删除节点的位置，然后使用 <code class="language-plaintext highlighter-rouge">shiftDown()</code> 来修复堆属性。<li><code class="language-plaintext highlighter-rouge">removeAt(index)</code> ：删除堆中的任意节点。将被删除节点与最后一个节点交换位置，交换后如果当前节点比父节点大（小），使用 <code class="language-plaintext highlighter-rouge">shiftUp()</code> 修复堆属性，如果它比子节点小（大），使用 <code class="language-plaintext highlighter-rouge">shiftDown()</code> 修复堆属性。</ul><p>以上所有的操作时间复杂度都是 O(log N) 。</p><p>堆的可以通过反复调用 <code class="language-plaintext highlighter-rouge">insert(value)</code> 来建立。</p><h2 id="堆的-java-实现">堆的 Java 实现</h2><p>这里使用了泛型和函数式接口，根据指定的 <code class="language-plaintext highlighter-rouge">Comparator</code> 来构造堆。</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">top.cloudli.heap</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Arrays</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Comparator</span><span class="o">;</span>

<span class="cm">/**
 * 堆（Heap）
 * 根据 {@link Comparator} 构造最大（小）堆
 *
 * @author Cloud Li
 */</span>
<span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">"unchecked"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Heap</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Object</span><span class="o">[]</span> <span class="n">heap</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">Comparator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">cmp</span><span class="o">=</span> <span class="nc">Comparator</span><span class="o">.</span><span class="na">comparingInt</span><span class="o">(</span><span class="nl">Object:</span><span class="o">:</span><span class="n">hashCode</span><span class="o">);</span>

    <span class="kd">public</span> <span class="nf">Heap</span><span class="o">(</span><span class="no">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">(</span><span class="n">array</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">Heap</span><span class="o">(</span><span class="no">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">,</span> <span class="nc">Comparator</span><span class="o">&lt;</span><span class="no">T</span><span class="o">&gt;</span> <span class="n">cmp</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">heap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">array</span><span class="o">.</span><span class="na">length</span><span class="o">];</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
            <span class="k">this</span><span class="o">.</span><span class="na">cmp</span> <span class="o">=</span> <span class="n">cmp</span><span class="o">;</span>
        <span class="n">build</span><span class="o">(</span><span class="n">array</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 构造堆
     *
     * @param array 用来构造堆的元素
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">build</span><span class="o">(</span><span class="no">T</span><span class="o">[]</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">for</span> <span class="o">(</span><span class="no">T</span> <span class="n">e</span> <span class="o">:</span> <span class="n">array</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">insert</span><span class="o">(</span><span class="n">e</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 插入一个元素
     *
     * @param e 被插入的元素
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">insert</span><span class="o">(</span><span class="no">T</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">length</span> <span class="o">==</span> <span class="n">heap</span><span class="o">.</span><span class="na">length</span><span class="o">)</span>
            <span class="n">resize</span><span class="o">();</span>
        <span class="n">heap</span><span class="o">[</span><span class="n">length</span><span class="o">]</span> <span class="o">=</span> <span class="n">e</span><span class="o">;</span>
        <span class="n">shiftUp</span><span class="o">(</span><span class="n">length</span><span class="o">);</span>
        <span class="n">length</span><span class="o">++;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="no">T</span> <span class="nf">peek</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 移除并返回根节点
     *
     * @return 根节点元素
     */</span>
    <span class="kd">public</span> <span class="no">T</span> <span class="nf">remove</span><span class="o">()</span> <span class="o">{</span>
        <span class="no">T</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>

        <span class="n">heap</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">heap</span><span class="o">[</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">];</span>
        <span class="n">length</span><span class="o">--;</span>
        <span class="n">shiftDown</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>

        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 删除指定位置的元素
     *
     * @param i 目标元素索引，起始为 0
     * @return 被删除的元素
     */</span>
    <span class="kd">public</span> <span class="no">T</span> <span class="nf">removeAt</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">ArrayIndexOutOfBoundsException</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>

        <span class="no">T</span> <span class="n">t</span> <span class="o">=</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>

        <span class="n">swap</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">length</span> <span class="o">-</span> <span class="mi">1</span><span class="o">);</span>
        <span class="n">length</span><span class="o">--;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span><span class="o">.</span><span class="na">compare</span><span class="o">((</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">parent</span><span class="o">(</span><span class="n">i</span><span class="o">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">shiftUp</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">shiftDown</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 扩容
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">resize</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Object</span><span class="o">[]</span> <span class="n">old</span> <span class="o">=</span> <span class="n">heap</span><span class="o">;</span>
        <span class="nc">Object</span><span class="o">[]</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">old</span><span class="o">.</span><span class="na">length</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">];</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">old</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">t</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">old</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
        <span class="n">heap</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 获取当前元素的父节点索引
     *
     * @param i 当前元素的索引
     * @return 父节点索引 floor(i - 1 / 2)
     */</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">parent</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 获取当前元素左节点的索引
     *
     * @param i 当前元素的索引
     * @return 左节点的索引 2i + 1
     */</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">left</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 获取当前元素右节点的索引
     *
     * @param i 当前元素的索引
     * @return 右节点的索引 2i + 2
     */</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">right</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="o">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 上移
     *
     * @param i 当前元素的索引
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">shiftUp</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">)</span>
            <span class="k">return</span><span class="o">;</span>

        <span class="c1">// 如果当前元素比它的父节点大（小），交换位置</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span><span class="o">.</span><span class="na">compare</span><span class="o">((</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">],</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">parent</span><span class="o">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">swap</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">parent</span><span class="o">);</span>
            <span class="n">shiftUp</span><span class="o">(</span><span class="n">parent</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 下移
     *
     * @param i 当前元素的索引
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">shiftDown</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">left</span> <span class="o">=</span> <span class="n">left</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="n">right</span> <span class="o">=</span> <span class="n">right</span><span class="o">(</span><span class="n">i</span><span class="o">),</span> <span class="n">child</span><span class="o">;</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="n">length</span> <span class="o">||</span> <span class="n">right</span> <span class="o">&gt;=</span> <span class="n">length</span><span class="o">)</span>
            <span class="k">return</span><span class="o">;</span>

        <span class="c1">// 如果当前元素比它的子节点小（大），交换位置</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span><span class="o">.</span><span class="na">compare</span><span class="o">((</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">left</span><span class="o">],</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">left</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">cmp</span><span class="o">.</span><span class="na">compare</span><span class="o">((</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">right</span><span class="o">],</span> <span class="o">(</span><span class="no">T</span><span class="o">)</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">child</span> <span class="o">=</span> <span class="n">right</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="n">child</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">child</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">swap</span><span class="o">(</span><span class="n">i</span><span class="o">,</span> <span class="n">child</span><span class="o">);</span>
            <span class="n">shiftDown</span><span class="o">(</span><span class="n">child</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="cm">/**
     * 交换元素
     *
     * @param i 索引
     * @param j 索引
     */</span>
    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">swap</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">,</span> <span class="kt">int</span> <span class="n">j</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Object</span> <span class="n">t</span> <span class="o">=</span> <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
        <span class="n">heap</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="n">heap</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
        <span class="n">heap</span><span class="o">[</span><span class="n">j</span><span class="o">]</span> <span class="o">=</span> <span class="n">t</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">size</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">maxSize</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">heap</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">Object</span><span class="o">[]</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Object</span><span class="o">[</span><span class="n">length</span><span class="o">];</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">arraycopy</span><span class="o">(</span><span class="n">heap</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">t</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">length</span><span class="o">);</span>
        <span class="k">return</span> <span class="nc">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Main</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Integer</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="o">{</span><span class="mi">5</span><span class="o">,</span> <span class="mi">2</span><span class="o">,</span> <span class="mi">7</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">6</span><span class="o">};</span>

        <span class="c1">// 构造一个大根堆</span>
        <span class="nc">Heap</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">heap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Heap</span><span class="o">&lt;&gt;(</span><span class="n">arr</span><span class="o">,</span> <span class="nl">Integer:</span><span class="o">:</span><span class="n">compareTo</span><span class="o">);</span>

        <span class="n">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"Size: %d, MaxSize: %d, nodes: %s\n"</span><span class="o">,</span> <span class="n">heap</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="n">heap</span><span class="o">.</span><span class="na">maxSize</span><span class="o">(),</span> <span class="n">heap</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>运行结果：</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>Size: 5, MaxSize: 5, nodes: <span class="o">[</span>7, 6, 5, 2, 3]

Process finished with <span class="nb">exit </span>code 0

</pre></table></code></div></div><p>如果要构造小根堆：</p><div class="language-java highlighter-rouge"><div class="code-header"> <span text-data=" Java "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nc">Heap</span><span class="o">&lt;</span><span class="nc">Integer</span><span class="o">&gt;</span> <span class="n">heap</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Heap</span><span class="o">&lt;&gt;(</span><span class="n">arr</span><span class="o">,</span> <span class="nc">Comparator</span><span class="o">.</span><span class="na">reverseOrder</span><span class="o">());</span>
</pre></table></code></div></div><p>如果要使用自定义对象，可以传入一个 lambda 表达式，指定比较规则。</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/'>数据结构</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="post-tag no-text-decoration" >数据结构</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=数据结构--堆 - Cloud&url=https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=数据结构--堆 - Cloud&u=https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=数据结构--堆 - Cloud&url=https://imcloudfloating.github.io/blog/posts/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E5%A0%86/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>最近更新</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/blog/posts/Docker%E5%AE%9E%E6%88%98-%E4%BD%BF%E7%94%A8-Dockerfile-%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F/">Docker 实战—使用 Dockerfile 构建镜像</a><li><a href="/blog/posts/Vue3-%E6%B8%B2%E6%9F%93%E5%87%BD%E6%95%B0%E4%B8%8E%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/">Vue3 渲染函数与代理对象踩坑记录</a></ul></div><div id="access-tags"> <span>热门标签</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/java/">Java</a> <a class="post-tag" href="/blog/tags/docker/">Docker</a> <a class="post-tag" href="/blog/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">函数式编程</a> <a class="post-tag" href="/blog/tags/%E6%8E%92%E5%BA%8F/">排序</a> <a class="post-tag" href="/blog/tags/%E7%AE%97%E6%B3%95/">算法</a> <a class="post-tag" href="/blog/tags/%E7%BA%BF%E7%A8%8B/">线程</a> <a class="post-tag" href="/blog/tags/%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/">集合框架</a> <a class="post-tag" href="/blog/tags/c/">C</a> <a class="post-tag" href="/blog/tags/cmake/">CMake</a> <a class="post-tag" href="/blog/tags/jvm/">JVM</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">文章内容</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/Vue3-%E6%B8%B2%E6%9F%93%E5%87%BD%E6%95%B0%E4%B8%8E%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/"><div class="card-body"> <span class="timeago small" >2021-11-23<i class="unloaded">2021-11-23T17:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vue3 渲染函数与代理对象踩坑记录</h3><div class="text-muted small"><p> 本文的示例基于 TypeScript 和 vue-class-component 假设有一个第三方组件的 option 属性，它包含了一个渲染函数： 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 export default class Foo extends Vue { @Prop(Number) private prop: numbe...</p></div></div></a></div><div class="card"> <a href="/blog/posts/CMake-%E5%85%A5%E9%97%A8/"><div class="card-body"> <span class="timeago small" >2021-10-11<i class="unloaded">2021-10-11T13:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CMake 快速入门</h3><div class="text-muted small"><p> 单源文件配置 假设有 main.c 文件： 1 2 3 4 5 6 7 #include &lt;stdio.h&gt; int main() { printf("Hello, World!"); return 0; } CMakeList.txt 内容： 1 2 3 4 5 6 7 # 设置 CMake 最低版本要求 cmake_minimum_requir...</p></div></div></a></div><div class="card"> <a href="/blog/posts/Steam-for-Linux-%E8%AE%BE%E7%BD%AE%E4%BB%A3%E7%90%86/"><div class="card-body"> <span class="timeago small" >2020-09-30<i class="unloaded">2020-09-30T16:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Steam for Linux 设置代理</h3><div class="text-muted small"><p> 用正确的姿势给 Steam for Linux 设置代理 为什么会有此文档？ 在使用 Linux Mint 时，发现 Steam 客户端打不开社区，但是 Chrome 可以打开，于是去找 Steam 客服， 得到的回复是让我使用 Ubuntu，行吧，反正我正好有换 Ubuntu 的打算（Mint 的字体渲染不清晰）。 然而，Ubuntu 的 Steam 客户端依然打不开社区，客服说让去...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/blog/posts/Java-HashMap/" class="btn btn-outline-primary" prompt="上一篇"><p>Java HashMap</p></a> <a href="/blog/posts/JVM-%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" class="btn btn-outline-primary" prompt="下一篇"><p>JVM 内存模型</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/imcloudfloating">Cloud Li</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">热门标签</h4><a class="post-tag" href="/blog/tags/java/">Java</a> <a class="post-tag" href="/blog/tags/docker/">Docker</a> <a class="post-tag" href="/blog/tags/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/">函数式编程</a> <a class="post-tag" href="/blog/tags/%E6%8E%92%E5%BA%8F/">排序</a> <a class="post-tag" href="/blog/tags/%E7%AE%97%E6%B3%95/">算法</a> <a class="post-tag" href="/blog/tags/%E7%BA%BF%E7%A8%8B/">线程</a> <a class="post-tag" href="/blog/tags/%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6/">集合框架</a> <a class="post-tag" href="/blog/tags/c/">C</a> <a class="post-tag" href="/blog/tags/cmake/">CMake</a> <a class="post-tag" href="/blog/tags/jvm/">JVM</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/blog/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
